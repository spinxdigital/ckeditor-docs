<!DOCTYPE html>
<!--
Copyright (c) 2003-2019, CKSource - Frederico Knabben. All rights reserved.
For licensing, see license.html or https://sdk.ckeditor.com/license.html.
-->
<html>
<head>
	<meta charset="utf-8">
	<meta name="description" content="Editor Size. Setting Custom Editor Width and Height.">
	<meta name="keywords" content="ckeditor, editor, wysiwyg, angular, integration">
	<meta name="sdk-samples" content="Classic editor">
	<meta name="sdk-category" content="sdk-framework-integration">
	<meta name="sdk-order" content="10">
	<title>Angular Integration</title>
	<link href="https://fonts.googleapis.com/css?family=Maven+Pro:700,500,400" rel="stylesheet">
	<link href="../template/theme/css/sdk.css" rel="stylesheet">
	<script src="../../ckeditor-dev/ckeditor.js"></script>
	<script src="assets/picoModal-2.0.1.min.js"></script>
	<script src="assets/contentloaded.js"></script>
	<script src="assets/simplesample.js"></script>
	<script src="assets/beautify-html.js"></script>
	<!--[if lt IE 9]>
	<script src="assets/html5shiv.min.js"></script>
	<![endif]-->
	<link rel="icon" href="../template/theme/img/favicon.ico">
</head>
<body>
<header class="sdk-header">
</header>
<section class="sdk-container">
	<nav class="sdk-sidebar">
	</nav>
	<section class="sdk-contents">
		<style>
			.cke_editable {
				color: black;
				background-color: white;
			}
		</style>

		<h1>Angular Integration <a class="documentation" href="https://ckeditor.com/docs/ckeditor4/latest/guide/dev_angular.html">Documentation</a></h1>

		<p>
			<strong>Angular 2+ integration</strong> allows usage of CKEditor 4 as an <a href="https://angular.io/">Angular</a> component, using <code>&lt;ckeditor&gt;</code> tag.
		</p>

		<p>
			Following examples showcase the most important features of React integration.
		</p>

		<p>
			<strong>Click and change an example:</strong>
		</p>

		<app-root></app-root>
		<script type="text/javascript" src="assets/angular/polyfills.js"></script>
		<script type="text/javascript" src="assets/angular/main.js"></script>
	</section>
</section>

<footer class="sdk-footer">
</footer>

<script type="text/jsx" data-sample="1" data-sample-preserve-whitespace data-sample-strip-outer-tag data-sample-template="empty" data-sample-highlighter="typescript">
	import { BrowserModule } from '@angular/platform-browser';
	import { NgModule } from '@angular/core';
	import { FormsModule } from '@angular/forms';
	import { RouterModule, Routes } from '@angular/router';
	import { AppComponent } from './app.component';

	import { CKEditorModule } from '@ckeditor/ckeditor4-angular';
	import { EditorTypesComponent } from './editor-types/editor-types.component';
	import { EventsComponent } from './events/events.component';
	import { DemoFormComponent } from './demo-form/demo-form.component';

	const appRoutes: Routes = [
		{ path: '', redirectTo: '/editor-types', pathMatch: 'full' },
		{ path: 'editor-types', component: EditorTypesComponent },
		{ path: 'events', component: EventsComponent },
		{ path: 'forms', component: DemoFormComponent }
	];

	@NgModule( {
		imports: [
			BrowserModule,
			FormsModule,
			CKEditorModule,
			RouterModule.forRoot( appRoutes, { useHash: true } )
		],
		declarations: [
			AppComponent,
			DemoFormComponent,
			EditorTypesComponent,
			EventsComponent
		],
		providers: [],
		bootstrap: [ AppComponent ]
	} )

	export class AppModule {
	}
</script>
<script type="text/jsx" data-sample="2" data-sample-preserve-whitespace data-sample-strip-outer-tag data-sample-template="empty" data-sample-highlighter="typescript">
	@Component( {
		selector: 'app-root',
		template:
			`<nav>
				<ul>
					<li><a routerLink="/editor-types" routerLinkActive="active">Editor types</a></li>
					<li><a routerLink="/events" routerLinkActive="active">Component events and Angular directives</a></li>
					<li><a routerLink="/forms" routerLinkActive="active">Integration with forms (<code>ngModel</code>)</a></li>
				</ul>
			</nav>

			<router-outlet></router-outlet>`
	} )
	export class AppComponent {
	}
</script>
<script type="text/jsx" data-sample="3" data-sample-preserve-whitespace data-sample-strip-outer-tag data-sample-template="empty" data-sample-highlighter="typescript">
	import { Component } from '@angular/core';

	@Component( {
		selector: 'app-editor-types',
		template:
			`<h2>{{( inline ? 'Inline' : 'Divarea')}} Editor:</h2>

			<ckeditor
				*ngIf="!inline"
				[(data)]="editorData">
			</ckeditor>

			<ckeditor
				*ngIf="inline"
				type="inline"
				[(data)]="editorData">
			</ckeditor>

			<button class="editor-type" (click)="changeEditorType()">Change editor type to {{ inline ? 'Divarea' : 'Inline' }}</button>`
	} )
	export class EditorTypesComponent {
		public isReadOnly = false;
		public editorData =
			`<p>Hello world!</p>`;

		inline = false;

		public componentEvents: string[] = [];

		changeEditorType() {
			this.inline = !this.inline;
		}
	}

</script>
<script type="text/jsx" data-sample="4" data-sample-preserve-whitespace data-sample-strip-outer-tag data-sample-template="empty" data-sample-highlighter="typescript">
	import { Component } from '@angular/core';

	interface ComponentEvent {
		name: string;
		counter: number;
		message: string;
	}

	@Component( {
		selector: 'app-events',
		template:
			`<h2>Events</h2>
			<ckeditor
				*ngIf="!isRemoved"
				data="<p>Hello world!</p>"
				[readOnly]="isReadOnly"
				[hidden]="isHidden"

				(ready)="onReady()"
				(change)="onChange()"
				(focus)="onFocus()"
				(blur)="onBlur()">
			</ckeditor>

			<h3>Events log:</h3>
			<ul class="events-log">
				<li *ngFor="let event of componentEvents">{{ event.message }}
					<span *ngIf="event.counter > 1"> ({{ event.counter }})</span>
				</li>
			</ul>

			<button (click)="clearEventsLog()">Clear events log</button>

			<h3>Angular directives:</h3>

			<p>
				<label><input type="checkbox" [(ngModel)]="isHidden">Hide editor with '[hidden]' directive.</label>
			</p>
			<p>
				<label><input type="checkbox" [(ngModel)]="isRemoved">Remove editor from DOM with '*ngIf' directive.</label>
			</p>
			<p>
				<label><input type="checkbox" [(ngModel)]="isReadOnly">Make editor read only.</label>
			</p>`
	} )
	export class EventsComponent {
		public isReadOnly = false;

		isHidden = false;

		isRemoved = false;

		inline = false;

		public componentEvents: ComponentEvent[] = [];

		clearEventsLog() {
			this.componentEvents.length = 0;
		}

		saveEvent( eventName: string ): void {
			const events = this.componentEvents;
			let message = `Editor ${ eventName === 'changed' ? 'has' : 'is' } ${ eventName }`;

			if ( events.length && events[ 0 ].name === eventName ) {
				events[ 0 ].counter++;
			} else {
				events.unshift( {
					name: eventName,
					counter: 1,
					message: message
				} );
			}
		}

		onReady(): void {
			this.saveEvent( 'ready' );
		}

		onChange(): void {
			this.saveEvent( 'changed' );
		}

		onFocus(): void {
			this.saveEvent( 'focused' );
		}

		onBlur(): void {
			this.saveEvent( 'blurred' );
		}
	}
</script>
<script type="text/jsx" data-sample="5" data-sample-preserve-whitespace data-sample-strip-outer-tag data-sample-template="empty" data-sample-highlighter="typescript">

	import {
		Component,
		ViewChild,
		AfterViewInit,
		ElementRef
	} from '@angular/core';

	import { NgForm } from '@angular/forms';

	@Component( {
		selector: 'app-demo-form',
		template:
			`<h2>Integration with forms (<code>ngModel</code>)</h2>

			<form (ngSubmit)="onSubmit()" #demoForm="ngForm">
				<h3>User profile form</h3>

				<div>
					<label for="name">Name</label>
					<input [(ngModel)]="model.name" type="text" name="name" id="name">
				</div>

				<div>
					<label for="surname">Surname</label>
					<input [(ngModel)]="model.surname" type="text" name="surname" id="surname">
				</div>

				<label for="description">Description</label>
				<ckeditor
					#editor
					[(ngModel)]="model.description"
					id="description"
					name="description">
				</ckeditor>

				<p *ngIf="description && description.dirty" class="alert">Description is "dirty".</p>
				<p *ngIf="description && description.touched" class="alert">Description has been "touched".</p>

				<p>
					<button type="reset" (click)="reset()">Reset form</button>
				</p>
				<p>
					<button type="submit">Submit this form</button>
				</p>
			</form>

			<h3>Editor data preview</h3>
			<p>
				Note that it's only a prove of concept of using the \`ngModel\`.
				It allows editing, but the editor strips out unknown tags and autoparagraphs text outside of block
				elements. Editor updates when textarea is blurred.
			</p>
			<textarea #preview
					  (focus)="isPreviewActive = true; previewModel = model.description"
					  (change)="isPreviewActive = false; model.description = previewModel"
					  [(ngModel)]="previewModel"></textarea>
			`,
		styleUrls: [ './demo-form.component.css' ]
	} )
	export class DemoFormComponent implements AfterViewInit {
		@ViewChild( 'demoForm' ) demoForm?: NgForm;
		@ViewChild( 'preview' ) preview: ElementRef;
		@ViewChild( 'editor' ) editor;

		public model = {
			name: 'John',
			surname: 'Doe',
			description: '<p>Hello world!</p>'
		};

		public isPreviewActive: boolean;

		public previewModel: string;

		public formDataPreview?: string;

		onSubmit() {
			alert( `Form submit, model: ${ JSON.stringify( this.model ) }` );
		}

		reset() {
			this.demoForm!.reset();
		}

		get description() {
			return this.demoForm!.controls.description;
		}

		ngAfterViewInit() {
			this.editor.dataChange.subscribe( ( value ) => {
				if ( !this.isPreviewActive ) {
					this.previewModel = value;
				}
			} );
		}
	}
</script>

</body>
</html>
